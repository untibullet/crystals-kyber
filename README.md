# üîê CRYSTALS-Kyber: –£—á–µ–±–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Python

–ü—Ä–æ—Å—Ç–∞—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å—Ç–∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è **CRYSTALS-Kyber** (—Å—Ö–µ–º–∞ CPA-secure PKE).

## üìã –ß—Ç–æ —ç—Ç–æ?

Kyber ‚Äî —ç—Ç–æ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∫–ª—é—á–æ–º, —É—Å—Ç–æ–π—á–∏–≤–∞—è –∫ –∞—Ç–∞–∫–∞–º –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤. –û–Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–¥–∞—á–µ **Module-LWE** (Learning With Errors over module lattices), –∫–æ—Ç–æ—Ä–∞—è —Å—á–∏—Ç–∞–µ—Ç—Å—è —Å–ª–æ–∂–Ω–æ–π –¥–∞–∂–µ –¥–ª—è –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.

**‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï:** –≠—Ç–æ —É—á–µ–±–Ω—ã–π –∫–æ–¥ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö!

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ?

- ‚úÖ **KeyGen** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—ã –∫–ª—é—á–µ–π (–ø—É–±–ª–∏—á–Ω—ã–π + —Å–µ–∫—Ä–µ—Ç–Ω—ã–π)
- ‚úÖ **Enc** ‚Äî —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ 256-–±–∏—Ç–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ **Dec** ‚Äî –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

## üìä –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ —Å—Ç–∞—Ç—å–∏ (—Ä–∞–Ω–Ω—è—è –≤–µ—Ä—Å–∏—è Kyber):

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `n` | 256 | –°—Ç–µ–ø–µ–Ω—å –º–Ω–æ–≥–æ—á–ª–µ–Ω–∞ (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–æ–ª—å—Ü–∞) |
| `k` | 3 | –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –º–æ–¥—É–ª—è (–º–∞—Ç—Ä–∏—Ü–∞ 3√ó3) |
| `q` | 7681 | –ú–æ–¥—É–ª—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ |
| `eta` | 4 | –ü–∞—Ä–∞–º–µ—Ç—Ä –±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —à—É–º–∞ |
| `du` | 11 | –ë–∏—Ç—ã —Å–∂–∞—Ç–∏—è –¥–ª—è u |
| `dv` | 3 | –ë–∏—Ç—ã —Å–∂–∞—Ç–∏—è –¥–ª—è v |

## üßÆ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—É—Ç—å (–±–µ–∑ —Ñ–æ—Ä–º—É–ª)

1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π:**
   - –°–æ–∑–¥–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É A (–ø—É–±–ª–∏—á–Ω–∞—è)
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –≤–µ–∫—Ç–æ—Ä s –∏ —à—É–º e
   - –í—ã—á–∏—Å–ª—è–µ–º t = A¬∑s + e
   - –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á = (t, A), —Å–µ–∫—Ä–µ—Ç–Ω—ã–π = s

2. **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
   - –ë–µ—Ä–µ–º –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (t, A)
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π —Å–µ–∫—Ä–µ—Ç r –∏ —à—É–º—ã
   - –ú–∞—Å–∫–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ: u = A^T¬∑r + —à—É–º, v = t^T¬∑r + —à—É–º + —Å–æ–æ–±—â–µ–Ω–∏–µ
   - –®–∏—Ñ—Ä—Ç–µ–∫—Å—Ç = (u, v)

3. **–î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
   - –í—ã—á–∏—Å–ª—è–µ–º v - s^T¬∑u
   - –ë–ª–∞–≥–æ–¥–∞—Ä—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ —Å–ª–∞–≥–∞–µ–º—ã–µ —Å A –∏ r —Å–æ–∫—Ä–∞—â–∞—é—Ç—Å—è
   - –û—Å—Ç–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ + –Ω–µ–±–æ–ª—å—à–æ–π —à—É–º
   - –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–±–∏—Ä–∞–µ—Ç —à—É–º ‚Üí –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–∏—Ç—ã

### –ü–æ—á–µ–º—É —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ?

üîπ **LWE-–∑–∞–¥–∞—á–∞**: –ù–∞–π—Ç–∏ —Å–µ–∫—Ä–µ—Ç s –∏–∑ –∑–∞—à—É–º–ª–µ–Ω–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π t = A¬∑s + e –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ  
üîπ **–ö–≤–∞–Ω—Ç–æ–≤–∞—è —Å—Ç–æ–π–∫–æ—Å—Ç—å**: –ù–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, —Ä–µ—à–∞—é—â–∏—Ö LWE —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ  
üîπ **–®—É–º**: –ú–∞–ª–µ–Ω—å–∫–∏–µ –æ—à–∏–±–∫–∏ —Å–∫—Ä—ã–≤–∞—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –Ω–æ –Ω–µ –º–µ—à–∞—é—Ç –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—é

## üöÄ –ó–∞–ø—É—Å–∫

```
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç
python main.py
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
======================================================================
KYBER.CPA - –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –†–ê–ë–û–¢–´
======================================================================

[–®–ê–ì 1] –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–õ–Æ–ß–ï–ô
----------------------------------------------------------------------
–ú–∞—Ç—Ä–∏—Ü–∞ A (–ø—É–±–ª–∏—á–Ω–∞—è):
  –§–æ—Ä–º–∞: (3, 3, 256)
  –î–∏–∞–ø–∞–∑–æ–Ω: 
  ...

[–®–ê–ì 2] –®–ò–§–†–û–í–ê–ù–ò–ï
----------------------------------------------------------------------
–ò—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–±–∏—Ç—ã): 11111111111111110000000000000000... (–≤—Å–µ–≥–æ 256 –±–∏—Ç)
...

[–®–ê–ì 3] –î–ï–®–ò–§–†–û–í–ê–ù–ò–ï
----------------------------------------------------------------------
–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:  11111111111111110000000000000000... (–≤—Å–µ–≥–æ 256 –±–∏—Ç)

[–†–ï–ó–£–õ–¨–¢–ê–¢]
======================================================================
‚úì –£–°–ü–ï–•! –°–æ–æ–±—â–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫.
```

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

| –≠—Ç–∞–ø | –û–±—ä–µ–∫—Ç | –†–∞–∑–º–µ—Ä | –ó–Ω–∞—á–µ–Ω–∏—è |
|------|--------|--------|----------|
| KeyGen | –ú–∞—Ç—Ä–∏—Ü–∞ A | (3, 3, 256) | 0..7680 |
| KeyGen | –°–µ–∫—Ä–µ—Ç s | (3, 256) | –º–∞–ª—ã–µ —á–∏—Å–ª–∞ ¬±4 |
| KeyGen | –ü—É–±–ª–∏—á–Ω—ã–π t | (3, 256) | —Å–∂–∞—Ç–æ –¥–æ 2048 |
| Enc | –®–∏—Ñ—Ä—Ç–µ–∫—Å—Ç u | (3, 256) | —Å–∂–∞—Ç–æ –¥–æ 2048 |
| Enc | –®–∏—Ñ—Ä—Ç–µ–∫—Å—Ç v | (256,) | —Å–∂–∞—Ç–æ –¥–æ 8 |
| Dec | –°–æ–æ–±—â–µ–Ω–∏–µ | 256 –±–∏—Ç | 0 –∏–ª–∏ 1 |

## üõ†Ô∏è –£–ø—Ä–æ—â–µ–Ω–∏—è –¥–ª—è —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª–µ–π

- ‚ùå –ë–µ–∑ NTT (Number Theoretic Transform) ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–≤
- ‚ùå –ë–µ–∑ –∫—Ä–∏–ø—Ç–æ—Å—Ç–æ–π–∫–∏—Ö PRNG ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—ã—á–Ω—ã–π `np.random`
- ‚ùå –ë–µ–∑ SHAKE-128/SHA3 ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ A –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é
- ‚ùå –ë–µ–∑ constant-time –æ–ø–µ—Ä–∞—Ü–∏–π ‚Äî –≤–æ–∑–º–æ–∂–Ω—ã timing-–∞—Ç–∞–∫–∏

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç—å—è Kyber](https://eprint.iacr.org/2017/634.pdf)
- [NIST PQC —Å—Ç–∞–Ω–¥–∞—Ä—Ç](https://csrc.nist.gov/Projects/post-quantum-cryptography)
- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è](https://github.com/pq-crystals/kyber)

## üéì –î–ª—è –∫–æ–≥–æ —ç—Ç–æ—Ç –∫–æ–¥?

‚úÖ –°—Ç—É–¥–µ–Ω—Ç—ã, –∏–∑—É—á–∞—é—â–∏–µ –ø–æ—Å—Ç–∫–≤–∞–Ω—Ç–æ–≤—É—é –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—é  
‚úÖ –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏, –∂–µ–ª–∞—é—â–∏–µ –ø–æ–Ω—è—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ Kyber  
‚úÖ –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞  

---

**–õ–∏—Ü–µ–Ω–∑–∏—è:** Public Domain  
**–ê–≤—Ç–æ—Ä —É—á–µ–±–Ω–æ–π –≤–µ—Ä—Å–∏–∏:** –£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø–æ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏
